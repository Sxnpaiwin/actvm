name: win-latest

on:
  workflow_dispatch:
    inputs:
      authcode:
        description: "${Env:PROGRAMFILES(X86)}\Google\Chrome Remote Desktop\CurrentVersion\remoting_start_host.exe" --code="4/0AQlEd8ycNpnLDm9jW2ztYIu1Rx-KtAn280oTOle3zV7WpaeD2T3LVCtPLShycScBAXZA8Q" --redirect-url="https://remotedesktop.google.com/_/oauthredirect" --name=$Env:COMPUTERNAME"
      pincode:
        description: "666666"
        required: true

jobs:
  setup:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v3
      - name: Initializing Setup
        run: ./setup/win-latest/setup.ps1
      - name: Starting Chrome Remote Desktop (CRD)
        run: ${{ github.event.inputs.authcode }} -pin=${{ github.event.inputs.pincode }}
      - name: Keep Alive
        run: ./setup/win-latest/timeout.ps1
